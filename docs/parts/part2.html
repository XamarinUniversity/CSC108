<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
    <title>Exercise 2: Write Code to throw, catch, and handle an Exception</title>
    <link rel="stylesheet" type="text/css" href="./res/styles/normalize.css">
    <link rel="stylesheet" type="text/css" href="./res/styles/prettify.css" />
    <link rel="stylesheet" type="text/css" href="./res/styles/styles.css">
</head>

<body>
    <!-- Use the same title as the StartHere -->
    <header>Learning C# with Xamarin: Debugging and Exceptions</header>

    <section id="main">

        <h1 id="page-title"></h1>

        <h2>Duration</h2>
        <p>20 minutes</p>

        <!-- - - - - - - - - Goals - - - - - - - - -->
        <h2 id="goals">Lab goals</h2>
        <p>
            In this exercise, you will throw an exception inside a method and use try and catch to handle the exception.
            If you use the lab instructions, your output will look something like:
        </p>
        <img src="./res/images/lab2-step2.PNG" />

        <p>
            To complete this exercise, you will perform the following steps:
        </p>
        <ol>
            <li>
                Modify the <b>Program.cs</b> code by adding a <code>throw</code> keyword inside a method to generate an exception when you receive invalid input.
            </li>
            <li>
                Run the application to view results of valid/invalid input.
            </li>
            <li>
                Add <code>try</code> and <code>catch</code> keywords to prevent invalid data from ending the program.
            </li>
            <li>
                There are <code>TODO</code> comments in the code to direct your work.
            </li>
        </ol>

        <h2>Required Assets</h2>
        <p>
            The provided <strong>Resources</strong> folder for this part contains a subfolder named <strong>Start</strong> with a solution
            you will use as starter code. The <strong>Completed</strong> subfolder contains a completed project you can use to check your work.
        </p>

        <!-- - - - - - - - - Steps - - - - - - - - -->
        <h1>Steps</h1>
        <p>
            Try to use the picture and above steps to complete the lab exercise, referring to the slides if you need any help.
            You can also use the following step-by-step instructions to fill in any knowledge gaps.
            Make sure to use the starter project located in <b>Resources/Start</b>.
        </p>

        <h2>Throw an Exception</h2>
        <p>
            First, you need to run the program and view the results.
        </p>
        <ol>
            <li>
                Run the application by pressing Control + F5. The output should look something like this:
            </li>
            <img class="indent-none" src="res/images/lab2-step1.PNG" />

            <li>
                Notice that there is a blank line between Mark and Stacey? This is an error in the <code>SayHello</code> method improperly allowing its parameter to be an empty string.
                You will now fix this by having the method detect an invalid parameter and throw an exception in response.
            </li>

            <li>
                Open the <b>Program.cs</b> source file and locate the <code>SayHello</code> method which has a <code>//TODO #1</code> comment marker.
            </li>

            <li>
                You want to test the input parameter <b>name</b> to see if it's null or empty. You can do this with the <code class="prettyprint">string.IsNullOrEmpty</code>
                static method. As the name implies, the method returns <code>true</code> if the passed string is null or empty.
            </li>

            <li>
                Add the code to throw a <code class="prettyprint">new ArgumentNullException()</code> if the parameter is invalid.
                This code should all be placed at the beginning of the method.
            </li>

            <li>
                Run the application in the debugger to see the results of the valid/invalid input. What kind of information do you get?
                Explore the exception object in the debugger to see what kind of information has been supplied.
            </li>
        </ol>
        <p>
            <a href="#" onclick="toggleCode(this,'throw');return false;" class="uiitem">Show Code</a>
            <div class="indent-large" id="throw" style="display:none;">
<pre class="prettyprint">
public static void SayHello (string name)
{
  //TODO #1: use string.IsNullOrEmpty to test the passed
  // parameter - if it's empty or null then throw an exception.
  <span class="highlight">if (string.IsNullOrEmpty(name))
  {
      throw new ArgumentNullException("name");
  }</span>
  messages.Add(name);
}
</pre>
            </div>
        </p>

        <h2>Catch an Exception</h2>
        <p>
            Now, you will add the <code>try</code> and <code>catch</code> keywords to handle the exception and stop the application from crashing.
        </p>
        <ol>
            <li>
                Add <code>try</code> and <code>catch</code> keywords around the call to the <code>SayHello</code> method to handle the exception
                and keep the application from being terminated. There is a <code>//TODO #2</code> comment marker where this needs to happen.
            </li>

            <li>
                Make sure to place the try/catch block around the method call, and not the <code>foreach</code> loop.
            </li>

            <li>
                In the <code>catch</code> body, add the string <code>"Anonymous name"</code> to the messages list so you account for the input
                with something valid in our UI.
            </li>

            <li>
                Run the application - the blank line should now be replaced with your new string:
            </li>
            <img src="res/images/lab2-step2.PNG" class="indent-none" />
        </ol>
        <p>
            <a href="#" onclick="toggleCode(this,'catch');return false;" class="uiitem">Show Code</a>
            <div class="indent-large" id="catch" style="display:none;">
<pre class="prettyprint">
//TODO #2: Add try and catch to stop the program crash
foreach (string name in names)
{
    <span class="highlight">try</span>
    {
        SayHello(name);
    }
    <span class="highlight">catch (ArgumentNullException)</span>
    {
        <span class="highlight">messages.Add("Anonymous name");</span>
    }
}
</pre>
            </div>
        </p>

        <!-- - - - - - - - - Summary - - - - - - - - -->
        <h1>Summary</h1>
        <p>
            In this lab exercise, you modified the ExceptionHandling application by adding a new throw statement to notify
            client code when your method received invalid input. You then added a try and catch statement so your program
            worked when given valid input and responded gracefully when given invalid data.
        </p>

        <div class="align-right">
            <a href="../Start%20Here.html">Go Back</a>
        </div>

    </section>

    <script src="./res/js/jquery.min.js"></script>
    <script src="./res/js/prettify.js"></script>
    <script src="./res/js/script.js"></script>

    <footer>Copyright (C) 2018 Xamarin Inc., Microsoft.</footer>
</body>
</html>
